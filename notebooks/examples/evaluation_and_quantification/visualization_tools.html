<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Batch Ensemble Networks" href="../batch_ensemble_notebook.html" /><link rel="prev" title="Interpretation techniques" href="interpretation_techniques.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Visualisation Tools - probly 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=201d0c9a" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">probly 0.3.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo/logo_light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../../_static/logo/logo_dark.png" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">The <code class="docutils literal notranslate"><span class="pre">probly</span></code> Python Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core_concepts.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../main_components.html">Main Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_topics.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples_and_tutorials.html">Examples and Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../methods.html">Implemented methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing_to_probly.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References and Further Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">FAQ and Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notebooks</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Notebook Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Notebook Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../utilities_and_layers/index.html">Utilities and Layers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Utilities and Layers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities_and_layers/custom_loss_functions.html">Custom Loss Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities_and_layers/metrics.html">Evaluation Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities_and_layers/probabilistic_layers.html">Key Probabilistic Layers in <code class="docutils literal notranslate"><span class="pre">probly</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities_and_layers/utility_functions.html">Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Evaluation and Quantification</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Evaluation and Quantification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plotting_credal_tutorial.html">Credal Sets Visualization Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="clustermargin_tutorial.html">A tutorial for clustervisualiser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="dirichlet_tutorial.html">Dirichlet distribution tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration_metrics.html">Calibration Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="interpretation_techniques.html">Interpretation techniques</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Visualisation Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../batch_ensemble_notebook.html"><strong>Batch Ensemble Networks</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../bayesian_transformation.html">Bayesian Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dropconnect_transformation.html">Dropconnect Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dropout_transformation.html">Dropout Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ensemble_subensemble_comparison.html"><strong>Ensemble vs SubEnsemble Notebook</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../ensemble_transformation.html">Ensemble Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html">Potential Advantages of Ensembling Random Forests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html#theoretical-background">2. Theoretical Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html#data-generation">3. Data Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html#random-forest-ensemble-prototype">4. Random Forest Ensemble Prototype</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html#uncertainty-analysis">5. Uncertainty Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html#performance-metrics">6. Performance Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Ensembling_RandomForests.html#conclusion">7. Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evidential_classification_transformation.html">Evidential Classification Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evidential_regression_transformation.html">Evidential Regression Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fashionmnist_ood_ensemble.html">Out-of-Distribution Detection with an Ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../label_relaxation_calibration.html">Calibration with Label Relaxation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lazy_dispatch_test.html">Lazy Dispatch Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multilib_demo.html">Multilib Demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pytraverse_tutorial.html">A Brief Introduction to PyTraverse</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sklearn_ensemble_tutorial.html">Uncertainty Quantification using scikit-learn-Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sklearn_selective_prediction.html">Using probly with scikit-learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subensembles_fast_uncertainty.html">Sub-Ensembles for Fast Uncertainty Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../synthetic_regression_dropout.html">Uncertainty for a Synthetic Regression Task using probly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../temperature_scaling_calibration.html">Calibration using Temperature Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../train_bnn_classification.html">Bayesian Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../train_evidential_classification.html">Evidential Model for Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../train_evidential_regression.html">Evidential Regression Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transformations_comparison.html">Transformation Comparison: Dropout vs DropConnect vs Ensemble vs Bayesian vs Evidential (PyTorch)</a></li>
</ul>
</li>
</ul>

</div>
</div><div style="text-align: center; margin-top: 1rem; margin-bottom: 1rem;">
  <a href="https://github.com/pwhofman/probly" target="_blank" rel="noopener noreferrer" title="GitHub Repository">
    <img src="../../../_static/github-mark.svg" alt="GitHub Logo" width="28" height="28" style="display: inline-block;">
  </a>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="visualisation-tools">
<h1>Visualisation Tools<a class="headerlink" href="#visualisation-tools" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>While numerical metrics provide a quantitative measure of uncertainty, visualizations offer an intuitive, qualitative understanding of a model’s predictions. A single plot can often reveal the nature of a model’s confidence in a way that is difficult to grasp from numbers alone. To this end, probly provides specialized tools for plotting predictive distributions, focusing on classification tasks.</p>
<p>Currently, the plotting module is designed to visualize the outputs of 3-class classifiers on a 2D simplex. This is a triangle where each corner represents 100% confidence in one of the three classes.</p>
<p>The library provides two main functions for this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The Simplex Plot is used to scatter individual predictions on this triangle, allowing you to see the distribution of a model&#39;s predictions across a dataset.

The Credal Set Plot is a more advanced tool for visualizing the uncertainty of a single prediction derived from multiple samples (e.g., from an ensemble or MC-Dropout). It plots the region of all possible probability distributions consistent with the model&#39;s outputs. A small, tight region indicates high confidence, while a large, spread-out region signifies high uncertainty.
</pre></div>
</div>
<p>These tools are essential for the qualitative interpretation and debugging of classification uncertainty.</p>
</section>
<section id="first-things-first">
<h2>0. First things first:<a class="headerlink" href="#first-things-first" title="Link to this heading">¶</a></h2>
<p>All modules mentioned here have more in depth notebooks to explain more detailed, how they are working.
You can find them under the section further reading.</p>
</section>
<section id="what-can-you-visualize-in-probly">
<h2>1. What can you visualize in probly?<a class="headerlink" href="#what-can-you-visualize-in-probly" title="Link to this heading">¶</a></h2>
<section id="credal-sets">
<h3>Credal Sets: <br><a class="headerlink" href="#credal-sets" title="Link to this heading">¶</a></h3>
<p>Based on the number of classes given in the visualizer, the <code class="docutils literal notranslate"><span class="pre">credal</span></code> package chooses between those three modules:</p>
<ul class="simple">
<li><p><strong>Intervall plot</strong> / <code class="docutils literal notranslate"><span class="pre">plot_2d</span></code>: Quick sanity checks for two-feature views (or 2D embeddings): cluster overlap, separation, and how uncertainty behaves in feature space.</p></li>
<li><p><strong>Ternary plot</strong> / <code class="docutils literal notranslate"><span class="pre">plot_3d</span></code>: Visualization of <strong>3-class probability vectors</strong> on a simplex: highlights confident regions (near corners) vs. ambiguous regions (towards the center / edges).</p></li>
<li><p><strong>Spider plot</strong> / <code class="docutils literal notranslate"><span class="pre">plot_multid</span></code>: Multi-class probability diagnostics when <code class="docutils literal notranslate"><span class="pre">n_classes</span> <span class="pre">&gt;</span> <span class="pre">3</span></code>: compact views to spot systematic uncertainty patterns across many classes.</p></li>
</ul>
</section>
<section id="specialized-plots">
<h3>Specialized plots:<br><a class="headerlink" href="#specialized-plots" title="Link to this heading">¶</a></h3>
<p>Upon our credal package, you can also visualize special plots:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_uncertainty</span></code>: Visualizes <strong>margin-based confidence</strong> between two 2D clusters by mapping the SVM decision margin into a smooth field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_dirichlet</span></code>: Plots <strong>Dirichlet density contours</strong> on the ternary simplex to illustrate “distributions over probabilities” (concentration, symmetry, and skew).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_coverage_efficency</span></code>: Shows the <strong>trade-off between empirical coverage and prediction set size</strong> across confidence levels (coverage vs. efficiency on a dual-axis view)</p></li>
</ul>
</section>
</section>
<section id="imports">
<h2>2. Imports<a class="headerlink" href="#imports" title="Link to this heading">¶</a></h2>
<p>To demonstrate, first let’s import the following modules:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">probly.visualization.clustermargin.clustervisualizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_uncertainty</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">probly.visualization.dirichlet.dirichlet_visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_dirichlet_plot</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">probly.visualization.credal.credal_visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_credal_plot</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">credal_visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_credal_plot</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">probly.visualization.efficiency.plot_coverage_efficiency</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoverageEfficiencyVisualizer</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">plot_coverage_final</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoverageEfficiencyVisualizer</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">visualizer</span> <span class="o">=</span> <span class="n">CoverageEfficiencyVisualizer</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Imports successfully loaded.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/955f5dffb6d3bd0cfab6efdba95a60468283ceba6112274685b69c6bb81ecf6e.png" src="../../../_images/955f5dffb6d3bd0cfab6efdba95a60468283ceba6112274685b69c6bb81ecf6e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imports successfully loaded.
</pre></div>
</div>
</div>
</div>
</section>
<section id="credal">
<h2>3. Credal<a class="headerlink" href="#credal" title="Link to this heading">¶</a></h2>
<p><strong>What the package does:</strong><br>
It takes an array of probability vectors (each summing to 1) and visualizes them as a credal set:</p>
<ul class="simple">
<li><p><strong>2 classes:</strong> interval band on a line</p></li>
<li><p><strong>3 classes:</strong> ternary plot with convex hull</p></li>
<li><p><strong>more than 3 classes:</strong> radar/spider plot with min–max envelope <br>
The public entry point is <code class="docutils literal notranslate"><span class="pre">create_credal_plot()</span></code>, which delegates to <code class="docutils literal notranslate"><span class="pre">dispatch_plot()</span></code> based on the number of classes.</p></li>
</ul>
<section id="public-api-credal-visualization-py">
<h3>3.1 Public API <code class="docutils literal notranslate"><span class="pre">credal_visualization.py</span></code><a class="headerlink" href="#public-api-credal-visualization-py" title="Link to this heading">¶</a></h3>
<p>This module provides the single public entry point for creating credal-set visualizations across different class counts (2D / 3D / multi-class).
<code class="docutils literal notranslate"><span class="pre">create_credal_plot()</span></code> takes the <code class="docutils literal notranslate"><span class="pre">input_data</span></code> plus optional flags to customize your plot.</p>
<p>It delegates all validation and plot selection to <code class="docutils literal notranslate"><span class="pre">dispatch_plot()</span></code> from <code class="docutils literal notranslate"><span class="pre">input_handling.py</span></code>, which decides which plot backend to use based on the number of classes.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">show=True</span></code>, it calls <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> so the figure is displayed immediately.</p>
</section>
<section id="input-handling-py">
<h3>3.2 <code class="docutils literal notranslate"><span class="pre">input_handling.py</span></code><a class="headerlink" href="#input-handling-py" title="Link to this heading">¶</a></h3>
<p>It selects and executes the correct plotting function based on class count.
By calling <code class="docutils literal notranslate"><span class="pre">create_credal_plot()</span></code> from <code class="docutils literal notranslate"><span class="pre">credal_visualization.py</span></code> your</p>
<p>Validates input_data is a non-empty NumPy array, at least 2D, with non-negative probabilities that sum to 1 per row, and ≥2 classes with <code class="docutils literal notranslate"><span class="pre">check_shape()</span></code>.
It then normalizes shapes by flattening higher-dimensional input sso plotting always sees a 2D matrix of samples with <code class="docutils literal notranslate"><span class="pre">normalize_input()</span></code>.<br></p>
<p><strong>Important to mention:</strong><br></p>
<ul class="simple">
<li><p>Your probabilities <strong>must sum to 1</strong>(otherwise you’ll get a clear error).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">choice=&quot;Probability&quot;</span></code> shows only raw points; <code class="docutils literal notranslate"><span class="pre">choice=&quot;MLE&quot;</span></code> shows only the mean; <code class="docutils literal notranslate"><span class="pre">choice=&quot;Credal&quot;</span></code> shows only the uncertainty region; <code class="docutils literal notranslate"><span class="pre">choice=None</span></code> shows both.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minmax=True</span></code> only has an effect for <strong>3-class plots</strong>.</p></li>
</ul>
</section>
<section id="plot-2d-py">
<h3>3.3 <code class="docutils literal notranslate"><span class="pre">plot_2d.py</span></code><a class="headerlink" href="#plot-2d-py" title="Link to this heading">¶</a></h3>
<p>This module implements the <strong>2-class credal visualization</strong>: an <em>interval plot</em> on a one dimentional probability axis.</p>
<p><strong>Core idea:</strong> <br>
If you have probabilities <code class="docutils literal notranslate"><span class="pre">[p1,</span> <span class="pre">p2]</span></code> with <code class="docutils literal notranslate"><span class="pre">p1</span> <span class="pre">+</span> <span class="pre">p2</span> <span class="pre">=</span> <span class="pre">1</span></code>, then the whole distribution is determined by <strong>one number</strong> (<code class="docutils literal notranslate"><span class="pre">p2</span></code>). So every prediction can be placed on a line from 0 to 1 (where <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">p2</span></code>)</p>
<p><strong>Use an interval plot when:</strong></p>
<ul class="simple">
<li><p>you have <strong>exactly 2 classes</strong> (binary classification)</p></li>
<li><p>you want a <strong>simple uncertainty summary</strong> of predicted probabilities</p></li>
</ul>
<p><strong>It’s especially useful for:</strong></p>
<ul class="simple">
<li><p>comparing <strong>model uncertainty</strong> across different inputs (narrow band = confident, wide band = uncertain)</p></li>
<li><p>showing uncertainty for a <strong>single data point</strong> (or a small set) in a compact way</p></li>
</ul>
<p><strong>Methods:</strong><br>
<code class="docutils literal notranslate"><span class="pre">IntervalVisualizer.probs_to_coords_2d()</span></code>: Maps each probability vector <code class="docutils literal notranslate"><span class="pre">[p1,</span> <span class="pre">p2]</span></code> to a 2D coordinate <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">IntervalVisualizer.interval_plot()</span></code>: Draws baseline and maps probability samples as blue points.</p>
<ul class="simple">
<li><p>optional <strong>MLE summary</strong> (red dot): the mean of the sampled <code class="docutils literal notranslate"><span class="pre">p2</span></code> values when <code class="docutils literal notranslate"><span class="pre">mle_flag=True</span></code></p></li>
<li><p>optional <strong>credal band</strong> (shaded region): the min–max interval of <code class="docutils literal notranslate"><span class="pre">p2</span></code> across samples <code class="docutils literal notranslate"><span class="pre">credal_flag=True</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">labels_2d</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Class A&quot;</span><span class="p">,</span> <span class="s2">&quot;Class B&quot;</span><span class="p">]</span>
<span class="n">create_credal_plot</span><span class="p">(</span>
    <span class="n">input_data</span><span class="o">=</span><span class="n">points_2d</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_2d</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Binary Credal Set (Interval)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b10cec555ba91919560fafd1f5a35eae22d12019cf18145fd8ce04ca00240a47.png" src="../../../_images/b10cec555ba91919560fafd1f5a35eae22d12019cf18145fd8ce04ca00240a47.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Binary Credal Set (Interval)&#39;}&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-3d-py">
<h3>3.4 <code class="docutils literal notranslate"><span class="pre">plot_3d.py</span></code><a class="headerlink" href="#plot-3d-py" title="Link to this heading">¶</a></h3>
<p>This module implements the <strong>3-class credal visualization</strong>: a <em>ternary plot</em> on the 2D probability simplex.</p>
<p><strong>Core idea:</strong> <br>
If you have probabilities <code class="docutils literal notranslate"><span class="pre">[p1,</span> <span class="pre">p2,</span> <span class="pre">p3]</span></code> with <code class="docutils literal notranslate"><span class="pre">p1</span> <span class="pre">+</span> <span class="pre">p2</span> <span class="pre">+</span> <span class="pre">p3</span> <span class="pre">=</span> <span class="pre">1</span></code>, every prediction is a point inside the simplex. The closer a point is to a corner, the higher the probability of that class.</p>
<p><strong>Use a ternary plot when:</strong></p>
<ul class="simple">
<li><p>you have <strong>exactly 3 classes</strong></p></li>
<li><p>you want to visualize a <strong>credal set</strong> as a region (instead of just individual points)</p></li>
</ul>
<p><strong>It’s especially useful for:</strong></p>
<ul class="simple">
<li><p>comparing <strong>uncertainty structure</strong></p></li>
<li><p>showing a <strong>credal set</strong> via the convex hull (and optionally min/max envelopes)</p></li>
</ul>
<p><strong>Methods:</strong><br>
<code class="docutils literal notranslate"><span class="pre">TernaryVisualizer.probs_to_coords_3d()</span></code>: Converts each probability triple <code class="docutils literal notranslate"><span class="pre">[p1,</span> <span class="pre">p2,</span> <span class="pre">p3]</span></code> into 2D ternary coordinates <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> so it can be plotted in a triangle.</p>
<p><code class="docutils literal notranslate"><span class="pre">TernaryVisualizer.ternary_plot()</span></code>: Draws the triangle simplex, axis ticks, and plots probability samples as points.</p>
<ul class="simple">
<li><p>optional <strong>MLE</strong> (red dot): the mean probability vector when <code class="docutils literal notranslate"><span class="pre">mle_flag=True</span></code></p></li>
<li><p>optional <strong>MLE guide lines</strong>: helper lines to make the MLE easier to read <code class="docutils literal notranslate"><span class="pre">draw_mle_prob_line</span></code></p></li>
<li><p>optional <strong>credal set</strong>: the <strong>convex hull</strong> around all points when <code class="docutils literal notranslate"><span class="pre">credal_flag=True</span></code></p></li>
<li><p>optional <strong>min/max envelope lines</strong>: draws up to 6 lines (min &amp; max for each class) when <code class="docutils literal notranslate"><span class="pre">minmax_flag=True</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">TernaryVisualizer.plot_convex_hull()</span></code>: Builds convex hull around points, depending on how many probabilities are given.</p>
<p><code class="docutils literal notranslate"><span class="pre">TernaryVisualizer.plot_minmax_lines()</span></code>: Computes per-class min and max probabilities across samples, then draws constant-probability lines for each bound.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">labels_3d</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Detractor&quot;</span><span class="p">,</span> <span class="s2">&quot;Passive&quot;</span><span class="p">,</span> <span class="s2">&quot;Promoter&quot;</span><span class="p">]</span>

<span class="n">create_credal_plot</span><span class="p">(</span>
    <span class="n">input_data</span><span class="o">=</span><span class="n">points_3d</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_3d</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Ternary Credal Set (Simplex)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/8f2ce609b188e283c4475147d56dd4ac9a55053fe3e66fc518f5669efbf8c9b7.png" src="../../../_images/8f2ce609b188e283c4475147d56dd4ac9a55053fe3e66fc518f5669efbf8c9b7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Ternary Credal Set (Simplex)&#39;}&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-multid-py">
<h3>3.5 <code class="docutils literal notranslate"><span class="pre">plot_multid.py</span></code><a class="headerlink" href="#plot-multid-py" title="Link to this heading">¶</a></h3>
<p>This module provides radar (spider) plots for multiclass probability predictions with <strong>more than three classes.</strong> It visualizes probability samples, MLE-style summaries, and credal uncertainty bands in a compact way. The plot is based on a custom Matplotlib radar projection created via <code class="docutils literal notranslate"><span class="pre">radar_factory</span></code>, supporting circular and polygonal frames.</p>
<p><strong>Core Idea:</strong><br>
Each axis corresponds to one class and the radius represents the predicted probability. For a probability vector <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">(p1,...,</span> <span class="pre">p)</span></code> with <code class="docutils literal notranslate"><span class="pre">sum(p)</span> <span class="pre">=</span> <span class="pre">1</span></code>, only the dominant (maximum-probability) class of each sample is plotted. Optionally, a mean probability vector MLE-style and a per-class min–max credal band can be shown. This makes the plot suitable for ensemble outputs, robust classification, and imprecise probability models.
<strong>Methods:</strong>
<code class="docutils literal notranslate"><span class="pre">radar_factory():</span></code></p>
<ul class="simple">
<li><p>Creates and registers a custom radar projection. Parameters: num_vars = number of classes; frame = “circle” or “polygon” (recommended).</p></li>
<li><p>Returns: theta (np.ndarray, shape (num_vars,)) giving angular class positions.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">spider_plot()</span></code>:</p>
<ul class="simple">
<li><p>General spider plot for multiclass credal predictions.</p></li>
<li><p>Input: probs (np.ndarray of shape (N, C), row-wise normalized) and labels (list of length C).</p></li>
<li><p>Options: <code class="docutils literal notranslate"><span class="pre">mle_flag</span></code> shows the mean probability vector; <code class="docutils literal notranslate"><span class="pre">credal_flag</span></code> shows the min–max credal band; <code class="docutils literal notranslate"><span class="pre">ax</span></code> is an optional existing radar axis.</p></li>
</ul>
<p><strong>Visualization:</strong><br>
<strong>Sample points:</strong> angle = most probable class, radius = probability value.
<strong>MLE summary:</strong> single point at the mean probability vector.
<strong>Credal band:</strong> shaded min–max envelope plus lower and upper bounds per class. Radial values lie in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>. For polygon frames, scaling uses <code class="docutils literal notranslate"><span class="pre">r_max</span> <span class="pre">=</span> <span class="pre">cos(π</span> <span class="pre">/</span> <span class="pre">C)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">points_multi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_classes</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="n">labels_multi</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;airplane&quot;</span><span class="p">,</span> <span class="s2">&quot;automobile&quot;</span><span class="p">,</span> <span class="s2">&quot;bird&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;deer&quot;</span><span class="p">,</span> <span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;frog&quot;</span><span class="p">,</span> <span class="s2">&quot;horse&quot;</span><span class="p">,</span> <span class="s2">&quot;ship&quot;</span><span class="p">,</span> <span class="s2">&quot;truck&quot;</span><span class="p">]</span>

<span class="n">create_credal_plot</span><span class="p">(</span>
    <span class="n">input_data</span><span class="o">=</span><span class="n">points_multi</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="n">labels_multi</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Multi-Class Credal Set (Spider)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/19f342959548cb21b7a8220ce7db15bbafe56ce43415de48c6b94b744588488a.png" src="../../../_images/19f342959548cb21b7a8220ce7db15bbafe56ce43415de48c6b94b744588488a.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;RadarAxes: title={&#39;center&#39;: &#39;Multi-Class Credal Set (Spider)&#39;}&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id1">
<h2>4. Specialized plots:<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Besides the <strong>credal based plots</strong>, our visualization tool includes three further visualizations that focus on different aspects of uncertainty and reliability.</p>
<p><strong>Cluster-margin (SVM) uncertainty plot:</strong><br>
A 2D visualization that uses an SVM’s <strong>distance to the decision boundary</strong> as a <em>margin-based uncertainty</em>.
It highlights <strong>where the ambiguous region between two clusters lies</strong> in feature space (high uncertainty near the boundary).</p>
<p><strong>Dirichlet / Evidential plot:</strong><br>
A visualization tailored to <strong>Dirichlet-based predictions</strong> (common in evidential deep learning). It helps interpret not only the predicted class probabilities, but also the <strong>strength / concentration</strong> of the Dirichlet distribution (how “certain” the model is overall).</p>
<p><strong>Coverage–Efficiency plot:</strong><br>
A diagnostic plot for <strong>prediction sets</strong>. It shows the trade-off between <strong>coverage</strong> (how often the true label is included in the set) and <strong>efficiency</strong> (how small the set is on average). This is especially useful to compare behaviour on <strong>ID vs. OOD</strong> data.</p>
<section id="clustervisualizer-py">
<h3>4.1 <code class="docutils literal notranslate"><span class="pre">clustervisualizer.py</span></code><a class="headerlink" href="#clustervisualizer-py" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">clustervisualizer.py</span></code> is a simple visualization tool for inspecting how <strong>confident a classifier separates two clusters</strong> in a 2D feature space.
It is based on a <strong>Support Vector Machine (SVM)</strong> and highlights where the model is uncertain about a sample’s class belonging.<br></p>
<p><strong>Core idea:</strong><br>
The visualization makes model uncertainty intuitive and easy to understand. Areas near the decision boundary appear highly uncertain, while regions farther away indicate higher confidence. As the two clusters move closer together or overlap, the region of uncertainty expands, demonstrating the difficulty of the classification. <br>
SVMs are <strong>margin-based classifiers</strong>. They <strong>separate classes</strong> by learning a decision boundary the maximizes the margin between samples of different classes. Using a soft margin allows misclassification but can improve the overall classification in the long run.</p>
<p>The SVM provides a margin-based confidence through its decision_function.
In this plot, the absolute margin values are inverted and normalized so that:<br></p>
<ul class="simple">
<li><p><strong>High uncertainty:</strong> values close to the decision boundary</p></li>
<li><p><strong>Low uncertainty:</strong> values far from the decision boundary</p></li>
</ul>
<p><strong>What the plot shows:</strong></p>
<ul class="simple">
<li><p>A continuous uncertainty background derived from the SVM decision function</p></li>
<li><p>The two input clusters overlaid as scatter points</p></li>
<li><p>A colorbar indicating relative uncertainty</p></li>
<li><p>Clear visual emphasis on ambiguous regions between classes</p></li>
</ul>
<p><strong>Methods:</strong> <br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_check_shape()</span></code>: Validates that input arrays are NumPy arrays with shape <strong>(n_samples, 2)</strong> and are non-empty.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_2_cluster_to_x()</span></code>: Stacks the two clusters into a single feature matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> with shape <code class="docutils literal notranslate"><span class="pre">(n1+n2,</span> <span class="pre">2)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_2_cluster_to_y()</span></code>: Creates a label vector <code class="docutils literal notranslate"><span class="pre">y</span></code> of zeros (for cluster1) and ones (for cluster2), shape <code class="docutils literal notranslate"><span class="pre">(n1+n2,)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_plot_svm_beam()</span></code>: Builds a dense 2D grid over the data range, evaluates the SVM <code class="docutils literal notranslate"><span class="pre">decision_function</span></code>, converts absolute margin to uncertainty, normalizes it to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>, and plots it as a filled contour heatmap + colorbar.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_uncertainty()</span></code>: Main entry point.</p>
<ul>
<li><p>validates <code class="docutils literal notranslate"><span class="pre">gamma</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code></p></li>
<li><p>scatters the two clusters with distinct colors</p></li>
<li><p>trains an <code class="docutils literal notranslate"><span class="pre">sklearn.svm.SVC</span></code> on <code class="docutils literal notranslate"><span class="pre">(X,</span> <span class="pre">y)</span></code></p></li>
<li><p>overlays the uncertainty heatmap from <code class="docutils literal notranslate"><span class="pre">_plot_svm_beam</span></code></p></li>
<li><p>optionally calls <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> and returns the Matplotlib <code class="docutils literal notranslate"><span class="pre">Axes</span></code></p></li>
</ul>
</li>
</ul>
<p><strong>Model Parameters: To adapt the underlying SVM behaviour change those parameters</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Kernel</span></code>: SVM kernel type (<code class="docutils literal notranslate"><span class="pre">“linear”</span></code>, <code class="docutils literal notranslate"><span class="pre">“rbf”</span></code>, <code class="docutils literal notranslate"><span class="pre">“sigmoid”</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code>: Regularization strength controlling tolerance for misclassification; Lower values allow more misclassification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code>: Kernel coefficient controlling the locality of influence; Higher values produce more localized decision boundaries</p></li>
</ul>
<p><strong>Visualization Options:</strong><br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">title</span></code>: Plot title</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_label</span></code>, <code class="docutils literal notranslate"><span class="pre">y_label</span></code>: Axis labels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">class_labels</span></code>: Custom names for the two classes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show</span></code>: If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the plot is displayed immediately; If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the Matplotlib Axes object is returned</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span>
<span class="n">cluster1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">cluster2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">plot_uncertainty</span><span class="p">(</span>
    <span class="n">cluster1</span><span class="p">,</span>
    <span class="n">cluster2</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Quick demo&quot;</span><span class="p">,</span>
    <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">gamma</span><span class="o">=</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/955f5dffb6d3bd0cfab6efdba95a60468283ceba6112274685b69c6bb81ecf6e.png" src="../../../_images/955f5dffb6d3bd0cfab6efdba95a60468283ceba6112274685b69c6bb81ecf6e.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Quick demo (kernel: rbf, C: 0.5)&#39;}, xlabel=&#39;Feature 1&#39;, ylabel=&#39;Feature 2&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="dirichlet-distribution-plot">
<h3>4.2 Dirichlet distribution plot<a class="headerlink" href="#dirichlet-distribution-plot" title="Link to this heading">¶</a></h3>
<p>Dirichlet distribution plots visualize probability density over the simplex of categorical probability vectors. Each point in the ternary plot represents a possible distribution over three classes, and the contours show which distributions are more likely under a given α. In machine learning, these plots are used to understand and debug Bayesian priors for categorical and multinomial models. They make clear how α controls uncertainty, sparsity, and bias toward specific classes. This is especially useful in topic models, mixture models, and uncertainty-aware classifiers where probabilities themselves are treated as random variables.</p>
<section id="how-to-generate-a-dirichlet-distribution-plot">
<h4>How to generate a Dirichlet distribution plot:<a class="headerlink" href="#how-to-generate-a-dirichlet-distribution-plot" title="Link to this heading">¶</a></h4>
<p>The user needs to call upon the create_dirichlet_plot function. They may pass through parameters such as: alpha, title and labels. Although only alpha is needed; title and labels will be defaulted to: <code class="docutils literal notranslate"><span class="pre">“Dirichlet</span> <span class="pre">Distribution</span> <span class="pre">X,</span> <span class="pre">Y,</span> <span class="pre">Z”</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;θ₁&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;θ₂&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;θ₃&quot;</span></code>.</p>
</section>
<section id="notes-on-alpha-values">
<h4>Notes on alpha values:<a class="headerlink" href="#notes-on-alpha-values" title="Link to this heading">¶</a></h4>
<p>The alpha values must be <strong>strictly positive</strong>; zero or negative values are not allowed, as they do not define a valid Dirichlet distribution. Each <code class="docutils literal notranslate"><span class="pre">αᵢ</span></code> controls how strongly the distribution favors higher probability mass for class i. Larger <code class="docutils literal notranslate"><span class="pre">α</span></code> values lead to smoother, more concentrated distributions, while values less than 1 encourage sparse, peaked distributions near the simplex corners. Unequal <code class="docutils literal notranslate"><span class="pre">α</span></code> values bias the distribution toward specific classes, encoding prior beliefs about class dominance.</p>
</section>
</section>
<section id="dirichlet-visualization-py">
<h3>4.2.1 <code class="docutils literal notranslate"><span class="pre">dirichlet_visualization.py</span></code><a class="headerlink" href="#dirichlet-visualization-py" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">dirichlet_visualization.py</span></code> is the user-facing API Module.</p>
<p><strong>Method:</strong> <br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">create_dirichlet_plot()</span></code>: Asserts that the <code class="docutils literal notranslate"><span class="pre">np.array</span></code> has three alpha values, sets default labels/title if non are given and takes the parameters to plot the Dirichlet distribution</p></li>
</ul>
</section>
<section id="plot-dirichlet-py">
<h3>4.2.2 <code class="docutils literal notranslate"><span class="pre">plot_dirichlet.py</span></code><a class="headerlink" href="#plot-dirichlet-py" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">plot_dirichlet.py</span></code> is the module that handles the actual generation of the Dirichlet distribution plot.</p>
<p><strong>Methods:</strong> <br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">triangle_corners()</span></code>: Returns the Cartesian coordinates of the three vertices of an equilateral ternary simplex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xy_to_barycentric()</span></code>: Converts a Cartesian point inside the ternary triangle into barycentric coordinates with numerical clipping for stability.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pdf()</span></code>: Evaluates the Dirichlet probability density function at given barycentric coordinates.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label_corners_and_vertices()</span></code>: Annotates the ternary plot with corner labels, vertex values, and evenly spaced edge tick marks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dirichlet_plot()</span></code>: Generates a filled contour plot of a Dirichlet distribution over a ternary simplex using a refined triangular mesh.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span> <span class="s2">&quot;Green&quot;</span><span class="p">,</span> <span class="s2">&quot;Blue&quot;</span><span class="p">)</span>
<span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Distribution of likelihood if balls in a Urn are: </span><span class="si">{</span><span class="n">labels</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">create_dirichlet_plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha_values</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0c0fa76d74a4154894b7cf96b78ce6797e957c027499889f065d48f85b108961.png" src="../../../_images/0c0fa76d74a4154894b7cf96b78ce6797e957c027499889f065d48f85b108961.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &quot;Distribution of likelihood if balls in a Urn are: (&#39;Red&#39;, &#39;Green&#39;, &#39;Blue&#39;)&quot;}&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="coverage-efficency">
<h3>4.3 Coverage Efficency<a class="headerlink" href="#coverage-efficency" title="Link to this heading">¶</a></h3>
<p>These modules implement the <strong>Coverage efficiency</strong> visualization to evaluate how <em>trustworthy</em> a classifier is when using <strong>prediction sets</strong> instead of single-label predictions.<br>
The plot tracks two critical metrics:</p>
<ul class="simple">
<li><p><strong>Coverage (blue, reliability):</strong>
The fraction of samples where the <strong>true class is included</strong> in the predicted set.
Ideally, empirical coverage follows the <strong>diagonal “Ideal Coverage”</strong> line (coverage ≈ target confidence).
If coverage falls <strong>below</strong> the diagonal, the model is <strong>overconfident</strong> (it promises more safety than it delivers).</p></li>
<li><p><strong>Efficiency (red, precision):</strong>
Measures how <strong>small</strong> the prediction set is on average (normalized).
Here, efficiency is plotted as <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">normalized_set_size</span></code>:</p>
<ul>
<li><p><strong>1.0</strong> ≈ very small sets (often size 1; very precise)</p></li>
<li><p><strong>0.0</strong> ≈ very large sets (close to all classes; very uncertain)</p></li>
</ul>
</li>
</ul>
<p>A dangerous failure mode is: <strong>coverage drops while efficiency stays high</strong>: the model is making <strong>confident but wrong</strong> predictions.</p>
<p><strong>Interpretation:</strong>
The visualization is based on <strong>prediction sets</strong> (similar in spirit to conformal prediction):
for a target confidence level <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">α)</span></code> the model outputs the <strong>smallest set of top-k classes</strong> whose cumulative probability mass reaches that confidence.</p>
<ul class="simple">
<li><p><strong>x-axis:</strong> Target confidence level <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">α)</span></code> (the safety level requested by the user)</p></li>
<li><p><strong>blue curve:</strong> empirical coverage achieved by those sets</p></li>
<li><p><strong>red curve:</strong> efficiency (how compact the sets remain while meeting confidence)</p></li>
</ul>
<p><strong>Explaination of OOD/ID</strong><br></p>
<ul class="simple">
<li><p><strong>ID (in-distribution):</strong> data similar to the training distribution</p></li>
<li><p><strong>OOD (out-of-distribution):</strong> data that differs from training (domain shift, novel patterns, etc.)</p></li>
</ul>
<p>In an ideal OOD scenario, <strong>efficiency should decrease</strong> (sets expand) because the model correctly expresses uncertainty.
If efficiency stays high on OOD while coverage drops, the model is <strong>overconfident under shift</strong>.</p>
<p><strong>How to access the module:</strong><br>
<code class="docutils literal notranslate"><span class="pre">coverage_efficiency_ood.py</span></code> provides two main entry points:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_coverage_efficiency_id_ood(probs_id,</span> <span class="pre">targets_id,</span> <span class="pre">probs_ood,</span> <span class="pre">targets_ood,</span> <span class="pre">...)</span></code>
Use this if your data is <strong>already split</strong> into ID and OOD parts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plot_coverage_efficiency_from_ood_labels(probs,</span> <span class="pre">targets,</span> <span class="pre">ood_labels,</span> <span class="pre">...)</span></code>
Use this if you have a <strong>combined dataset</strong> with binary markers (default convention: <code class="docutils literal notranslate"><span class="pre">0=ID</span></code>, <code class="docutils literal notranslate"><span class="pre">1=OOD</span></code>).
The function automatically splits the arrays and calls the ID/OOD plotting routine.</p></li>
</ul>
<p><strong>Inputs and configuration:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">probs</span></code>: must be a 2D array of shape <strong>(N, C)</strong> (class probabilities per sample; rows should sum to 1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">targets</span></code>: must be a 1D array of shape <strong>(N,)</strong> (integer class indices)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ood_labels</span></code> (optional): must be 1D of shape <strong>(N,)</strong> and use the chosen ID/OOD label convention</p></li>
</ul>
<p>Styling (colors, fonts, line styles) is controlled centrally via <code class="docutils literal notranslate"><span class="pre">config.py</span></code> for consistent visuals across the library.</p>
<p><strong>Implementation overview (what the code actually does):</strong><br></p>
<p><code class="docutils literal notranslate"><span class="pre">CoverageEfficiencyVisualizer._compute_metrics()</span></code>:</p>
<ul class="simple">
<li><p>sorts probabilities per sample (descending)</p></li>
<li><p>for each confidence level <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">α)</span></code>, selects the smallest top-k set reaching that cumulative probability</p></li>
<li><p>computes:</p>
<ul>
<li><p><strong>coverage</strong>: whether the true label lies within that set</p></li>
<li><p><strong>efficiency</strong>: average set size (later normalized)</p></li>
</ul>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">CoverageEfficiencyVisualizer.plot_coverage_efficiency()</span></code>:</p>
<ul class="simple">
<li><p>plots <strong>ideal coverage</strong> (diagonal) vs <strong>empirical coverage</strong> (blue)</p></li>
<li><p>plots <strong>efficiency</strong> on a second y-axis (red), as <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">normalized_set_size</span></code></p></li>
<li><p>returns the Matplotlib <code class="docutils literal notranslate"><span class="pre">Axes</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">coverage_efficiency_ood.py</span></code>:</p>
<ul class="simple">
<li><p>validates shapes</p></li>
<li><p>plots ID and OOD <strong>side-by-side</strong>, or performs the split first when <code class="docutils literal notranslate"><span class="pre">ood_labels</span></code> are provided</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In-Order Distribution:</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_classes</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">probs_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_classes</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="n">targets_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">probs_id</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">plot_coverage_efficiency</span><span class="p">(</span>
    <span class="n">probs</span><span class="o">=</span><span class="n">probs_id</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="n">targets_id</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;In-Distribution (ID): High Confidence &amp; Efficiency&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Out-of-Order Distribution:</span>
<span class="n">probs_ood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_classes</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="n">targets_ood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">visualizer</span><span class="o">.</span><span class="n">plot_coverage_efficiency</span><span class="p">(</span>
    <span class="n">probs</span><span class="o">=</span><span class="n">probs_ood</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="n">targets_ood</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Out-of-Distribution (OOD): Low Confidence &amp; Efficiency&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/6caf79bc5fbebb13acd9b20b374a0e6e908f84d5f50a54a1417e97dac3bfe50a.png" src="../../../_images/6caf79bc5fbebb13acd9b20b374a0e6e908f84d5f50a54a1417e97dac3bfe50a.png" />
<img alt="../../../_images/50f851992bf436dc61698066fa996d7d8ad237efa28a56fc1fb4ea3f4547ae25.png" src="../../../_images/50f851992bf436dc61698066fa996d7d8ad237efa28a56fc1fb4ea3f4547ae25.png" />
</div>
</div>
</section>
<section id="further-reading">
<h3>5. Further reading:<a class="headerlink" href="#further-reading" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Credal:</strong> <span class="xref std std-doc">Credal Tutorial</span></p></li>
<li><p><strong>Clustermargin:</strong> <span class="xref std std-doc">Clustermargin Tutorial</span></p></li>
<li><p><strong>Dirichlet:</strong> <span class="xref std std-doc">Dirichlet Tutorial</span></p></li>
<li><p><strong>Coverage–Efficiency:</strong> <span class="xref std std-doc">Coverage-Efficiency Tutorial</span></p></li>
</ul>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../batch_ensemble_notebook.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><strong>Batch Ensemble Networks</strong></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="interpretation_techniques.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Interpretation techniques</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, probly team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Visualisation Tools</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#first-things-first">0. First things first:</a></li>
<li><a class="reference internal" href="#what-can-you-visualize-in-probly">1. What can you visualize in probly?</a><ul>
<li><a class="reference internal" href="#credal-sets">Credal Sets: <br></a></li>
<li><a class="reference internal" href="#specialized-plots">Specialized plots:<br></a></li>
</ul>
</li>
<li><a class="reference internal" href="#imports">2. Imports</a></li>
<li><a class="reference internal" href="#credal">3. Credal</a><ul>
<li><a class="reference internal" href="#public-api-credal-visualization-py">3.1 Public API <code class="docutils literal notranslate"><span class="pre">credal_visualization.py</span></code></a></li>
<li><a class="reference internal" href="#input-handling-py">3.2 <code class="docutils literal notranslate"><span class="pre">input_handling.py</span></code></a></li>
<li><a class="reference internal" href="#plot-2d-py">3.3 <code class="docutils literal notranslate"><span class="pre">plot_2d.py</span></code></a></li>
<li><a class="reference internal" href="#plot-3d-py">3.4 <code class="docutils literal notranslate"><span class="pre">plot_3d.py</span></code></a></li>
<li><a class="reference internal" href="#plot-multid-py">3.5 <code class="docutils literal notranslate"><span class="pre">plot_multid.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">4. Specialized plots:</a><ul>
<li><a class="reference internal" href="#clustervisualizer-py">4.1 <code class="docutils literal notranslate"><span class="pre">clustervisualizer.py</span></code></a></li>
<li><a class="reference internal" href="#dirichlet-distribution-plot">4.2 Dirichlet distribution plot</a><ul>
<li><a class="reference internal" href="#how-to-generate-a-dirichlet-distribution-plot">How to generate a Dirichlet distribution plot:</a></li>
<li><a class="reference internal" href="#notes-on-alpha-values">Notes on alpha values:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dirichlet-visualization-py">4.2.1 <code class="docutils literal notranslate"><span class="pre">dirichlet_visualization.py</span></code></a></li>
<li><a class="reference internal" href="#plot-dirichlet-py">4.2.2 <code class="docutils literal notranslate"><span class="pre">plot_dirichlet.py</span></code></a></li>
<li><a class="reference internal" href="#coverage-efficency">4.3 Coverage Efficency</a></li>
<li><a class="reference internal" href="#further-reading">5. Further reading:</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=4621528c"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=ccdb6887"></script>
    </body>
</html>